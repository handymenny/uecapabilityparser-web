import{u as S,z as tt,q as b,w as et,h,G as nt,d as m,t as v,b as u,c as y,F as z,s as st}from"./q-CS8-Vk9R.js";import{A as it}from"./q-D5EJ5lgG.js";import{S as A}from"./q-C2qd-d0P.js";import{a as U,E as M}from"./q-ChQqLFQJ.js";import{_ as w}from"./q-C7i0xNVT.js";import{B}from"./q-jcbEK2Wa.js";import{C as rt}from"./q-D5xba4nW.js";import{M as at}from"./q-C65u-G1u.js";import{T as H}from"./q-Dh6C5KXZ.js";const I=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;const O=typeof TextEncoder=="function"?new TextEncoder:void 0,ot="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",E=Array.prototype.slice.call(ot);(t=>{let e={};return t.forEach((n,i)=>e[n]=i),e})(E);const x=String.fromCharCode.bind(String);typeof Uint8Array.from=="function"&&Uint8Array.from.bind(Uint8Array);const j=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),lt=t=>{let e,n,i,r,l="";const a=t.length%3;for(let s=0;s<t.length;){if((n=t.charCodeAt(s++))>255||(i=t.charCodeAt(s++))>255||(r=t.charCodeAt(s++))>255)throw new TypeError("invalid character found");e=n<<16|i<<8|r,l+=E[e>>18&63]+E[e>>12&63]+E[e>>6&63]+E[e&63]}return a?l.slice(0,a-3)+"===".substring(a):l},V=typeof btoa=="function"?t=>btoa(t):I?t=>Buffer.from(t,"binary").toString("base64"):lt,$=I?t=>Buffer.from(t).toString("base64"):t=>{let n=[];for(let i=0,r=t.length;i<r;i+=4096)n.push(x.apply(null,t.subarray(i,i+4096)));return V(n.join(""))},Q=(t,e=!1)=>e?j($(t)):$(t),ut=t=>{if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?x(192|e>>>6)+x(128|e&63):x(224|e>>>12&15)+x(128|e>>>6&63)+x(128|e&63)}else{var e=65536+(t.charCodeAt(0)-55296)*1024+(t.charCodeAt(1)-56320);return x(240|e>>>18&7)+x(128|e>>>12&63)+x(128|e>>>6&63)+x(128|e&63)}},ct=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,pt=t=>t.replace(ct,ut),k=I?t=>Buffer.from(t,"utf8").toString("base64"):O?t=>$(O.encode(t)):t=>V(pt(t)),Y=(t,e=!1)=>e?j(k(t)):k(t),G="[prepocessor](https://github.com/HandyMenny/uecapabilityparser-prepocessor)",K=`PcapNg isn't supported, please convert this file to PCAP before submitting.<br>You can use ${G} to do that.`,ft=`Input data too big for this instance.<br> You can use ${G} to reduce its size.<br>Alternatively, you can run you own instance or use cli.`,dt=async t=>{const e=await t.arrayBuffer();return Q(new Uint8Array(e))},J=t=>{var i;const n=(i=t.replace(/\s|0x|,|;/g,"").toUpperCase().match(/[0-9A-Fa-f]{1,2}/g))==null?void 0:i.map(r=>parseInt(r,16));return Uint8Array.from(n??[])},mt=async(t,e)=>t in["E","SHNR","P","DLF","QMDL","HDF","SDM"]?Q(J(e)):Y(e),xt=(t,e)=>{if(t in["E","SHNR","P","DLF","QMDL","HDF","SDM"]){const i=J(e);return new File([i],"")}else return new File([e],"")},_=async(t,e,n,i)=>{const r=t.get(n),l=await mt(e,r);let a="";const s=t.getAll(i);if(s.length==1)a=await dt(s[0]);else if(s.length>1){const c=s.map(p=>p.text()),f=await Promise.all(c);a=Y(f.reduce((p,o)=>`${p}

${o}`))}return a.length>0?a:l},R=(t,e,n,i)=>{const r=t.get(n),l=xt(e,r),s=t.getAll(i).filter(c=>c.size>0);return s.length>0?s:l.size>0?[l]:[]},X=(t,e)=>e?t.startsWith("Cg0NC"):t[0]==10&&t[1]==13&&t[2]==13&&t[3]==10,yt=async t=>{const n=await t.slice(0,4).arrayBuffer();return new Uint8Array(n)},gt=async t=>{const e=new FormData(t),n=e.get("0-type"),i=e.get("0-description"),r=await _(e,n,"0-inputText","0-inputFile");let l=null,a=null;n=="H"&&(l=await _(e,n,"0-inputENDCText","0-inputENDCFile"),a=await _(e,n,"0-inputNRText","0-inputNRFile"));const s={type:n,input:r,inputENDC:l,inputNR:a,multiple0xB826:!0,description:i};return(await U.post(M.PARSE,s)).data},ht=async(t,e)=>{const n=new FormData(t),i=[];for(let a=0;a<e;a++){const s=n.get(`${a}-type`),c=n.get(`${a}-description`),f=await _(n,s,`${a}-inputText`,`${a}-inputFile`);if(s=="P"&&X(f,!0))throw K;let p=[f],o=[];if(s=="H"){const C=await _(n,s,`${a}-inputENDCText`,`${a}-inputENDCFile`),T=await _(n,s,`${a}-inputNRText`,`${a}-inputNRFile`);p=[f,C,T],o=["LTE","ENDC","NR"]}const d={type:s,inputs:p,subTypes:o,description:c};i.push(d)}const l=(await U.post(M.PARSEMULTI,i)).data;if(l.capabilitiesList==null)throw"Parsing failed. The input is invalid or doesn't contain valid data.";return l},vt=async(t,e)=>{const n=new FormData(t),i=[],r=[];for(let o=0;o<e;o++){const d=n.get(`${o}-type`),C=n.get(`${o}-description`),T=R(n,d,`${o}-inputText`,`${o}-inputFile`);let P=[...T];if(d=="P"){const g=P[0];if(g!=null){const Z=await yt(g);if(X(Z,!1))throw K}}let N=null,L=null;d=="H"&&(N=R(n,d,`${o}-inputENDCText`,`${o}-inputENDCFile`)[0],L=R(n,d,`${o}-inputNRText`,`${o}-inputNRFile`)[0],P=[...T,N,L]);const D=[],q=[];let W=r.length;P.forEach(g=>{g!=null&&(d=="H"&&(g==N?D.push("ENDC"):g==L?D.push("NR"):D.push("LTE")),r.push(g),q.push(W),W++)}),i.push({type:d,inputIndexes:q,subTypes:D,description:C})}const l=await A.getMaxRequestSize();if(r.map(o=>o.size).reduce((o,d)=>o+d)>=l-1e3)throw ft;const c=M.PARSEMULTIPART,p=(await U.postForm(c,{requests:JSON.stringify(i),file:r})).data;if(p.capabilitiesList==null)throw"Parsing failed. The input is invalid or doesn't contain valid data.";return p},_t=async(t,e)=>{const[n,i,r,l,a]=S();r.value=void 0,a.value=!0;try{let s,c,f,p;if(i.value){c="/view/multi/?id=";let o;await A.isMultiPartSupported()?o=await vt(e,n.value):o=await ht(e,n.value),f=o.id,s=o.capabilitiesList??[],p=o.description}else{c="/view/?id=";const o=await gt(e);f=o.id,s=[o]}f!=null&&(history.pushState({},"",c+f),window.addEventListener("popstate",()=>{r.value=void 0,l.value=void 0,a.value=!1},{once:!0})),a.value=!1,r.value=s,l.value=p}catch(s){throw a.value=!1,new it(s)}},bt=async()=>{const[t]=S();t.value>1&&t.value--},wt=async()=>{const[t,e]=S();t.value=await A.isMultiSupported(),e.value=await A.getSupportedLogs()},Et=async()=>{const[t]=S();t.value++},Tt=tt(b(()=>w(()=>import("./q-DL155Z2Q.js"),[]),"s_RxJnt3K50Co")),Dt=()=>{et();const t=h(void 0),e=h(void 0),n=h(!1),i=h(1),r=h(!1),l=h([]),a=b(()=>w(()=>Promise.resolve().then(()=>F),void 0),"s_XNkxOB2umQE",[i,r,t,e,n]);return nt(b(()=>w(()=>Promise.resolve().then(()=>F),void 0),"s_Rsa6BhqxF4U",[r,l]),{strategy:"document-ready"}),m(z,{children:[v("div",null,{class:y((s,c)=>c.value||s.value!==void 0?"hidden":"",[t,n])},[m(H,{text:"Parser",addClasses:"mb-4",[u]:{text:u,addClasses:u}},3,"aW_0"),v("div",null,{class:"my-[-1rem] flex flex-1 flex-col"},v("form",null,{class:"m-auto w-full max-w-2xl",autocomplete:"off","preventdefault:submit":!0,onSubmit$:a},[[...Array(i.value).keys()].map(s=>m(Tt,{prefix:`${s}-`,submitting:n,get multiparse(){return r.value},get supportedLogs(){return l.value},[u]:{submitting:u,multiparse:y(c=>c.value,[r]),supportedLogs:y(c=>c.value,[l])}},3,s)),v("div",null,{class:"flex flex-wrap gap-x-4"},[m(B,{type:"button",label:"Remove",get hidden(){return!r.value||i.value<2},onClick$:b(()=>w(()=>Promise.resolve().then(()=>F),void 0),"s_PZjg2AEq0h0",[i]),[u]:{type:u,label:u,hidden:y((s,c)=>!c.value||s.value<2,[i,r]),onClick$:u}},3,"aW_1"),m(B,{type:"button",label:"Add",get hidden(){return!r.value},onClick$:b(()=>w(()=>Promise.resolve().then(()=>F),void 0),"s_iTi9KwAcEYg",[i]),[u]:{type:u,label:u,hidden:y(s=>!s.value,[r]),onClick$:u}},3,"aW_2"),v("div",null,{class:y(s=>s.value>1&&"min-w-full"||"flex-1",[i])},m(B,{type:"submit",label:"Submit",[u]:{type:u,label:u}},3,"aW_3"),1,null)],1,null)],1,null),1,null)],1,null),t.value==null&&n.value&&v("div",null,{class:"flex flex-1 flex-col"},m(rt,{centered:!0,[u]:{centered:u}},3,"aW_4"),1,"aW_5"),t.value!==void 0&&!n.value&&m(z,{children:[m(H,{text:"View",[u]:{text:u}},3,"aW_6"),m(at,{get capabilitiesList(){return t.value},get groupDescription(){return e.value},[u]:{capabilitiesList:y(s=>s.value,[t]),groupDescription:y(s=>s.value,[e])}},3,"aW_7")]},1,"aW_8")]},1,"aW_9")},F=Object.freeze(Object.defineProperty({__proto__:null,_hW:st,s_PZjg2AEq0h0:bt,s_Rsa6BhqxF4U:wt,s_XNkxOB2umQE:_t,s_iTi9KwAcEYg:Et,s_wW02utqxH8E:Dt},Symbol.toStringTag,{value:"Module"}));export{st as _hW,bt as s_PZjg2AEq0h0,wt as s_Rsa6BhqxF4U,_t as s_XNkxOB2umQE,Et as s_iTi9KwAcEYg,Dt as s_wW02utqxH8E};
